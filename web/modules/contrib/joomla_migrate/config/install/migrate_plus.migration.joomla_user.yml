# Migration configuration for user accounts. We've described most of what goes
# into migration configuration in migrate_plus.migration.beer_term.yml, so won't
# repeat that here.
id: joomla_user
label: Joomla Users
migration_group: joomla
source:
  plugin: joomla_user
destination:
  plugin: entity:user
process:
  pass: password
  mail: email
  init: email
  # status: status
  roles:
    plugin: default_value
    default_value: 2

  # Here's a new process plugin - dedupe_entity. Our source site allowed there
  # to be multiple user accounts with the same username, but Drupal wants
  # usernames to be unique. This plugin allows us to automatically generate
  # unique usernames when we detect collisions.
  name:
    plugin: dedupe_entity
    # The name of the source field containing the username.
    source: username
    # These next two settings identify the destination-side field to check for
    # duplicates. They say "see if the incoming 'name' matches any existing
    # 'name' field in any 'user' entity".
    entity_type: user
    field: name
    # Finally, this specifies a string to use between the original value and the
    # sequence number appended to make the value unique. Thus, the first 'alice'
    # account gets the name 'alice' in Drupal, and the second one gets the name
    # 'alice_1'.
    postfix: _

migration_dependencies: {}

# When a module is creating a custom content type it needs to add an
# enforced dependency to itself, otherwise the content type will persist
# after the module is disabled. See: https://www.drupal.org/node/2629516.
dependencies:
  enforced:
    module:
      - joomla_migrate
